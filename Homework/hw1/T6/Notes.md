# 两篇论文阅读
> 注：由于文章过于陈旧，以下描述都基于论文刚发出来的时间节点。
## A public key cryptosystem and a signature scheme based on discrete logarithms
[论文速通传送门](https://www.cnblogs.com/pam-sh/p/14933371.html)
### 贡献（Summarize）
- 实现了 Diffie - Hellman 密钥分发方案，该系统的安全性与 DH 密钥分发方案的安全性等价。
- 提出了一种新的签名方案，依赖于有限域上离散对数的计算难度。目前还没有证明攻破系统等同于计算离散对数。
- 尝试了一些对提出的签名方案的攻击，都没有成功。

### 公钥加密系统
#### DH 密钥分发方案
- 过程：略
- $p-1$ 至少要有一个大的素因子，否则离散对数问题会变得很简单。[参考论文](https://ee.stanford.edu/~hellman/publications/28.pdf)

#### ElGamal 公钥加密系统
- 密文长度是消息长度的两倍。
- 为了使 public file 尽可能简洁，$p$ 和 $g$ 可以在一组用户中共享。
- 使用相同的值 $k$ 来加密消息的多个块是不可取的，因为如果 $k$ 被使用了多次，只要入侵者破解了消息的一个块 $m$，就能够轻易计算其他块。
- 攻破这个系统的难度和攻破 Diflte - Hellman 分配方案的难度是一样的。

### ElGamal 签名方案
- 过程：略
- 选择的k的值不应该使用超过一次。
 
### 一些攻击方法
#### 恢复秘密密钥 $x$ 的攻击
- 突破口 1：给定消息序列 $\{m_i:i=1,2,...,l\}$ 以及对应的签名序列 $\{(r_i,s_i):i=1,2,...,l\}$，攻击者希望从 $l$ 个线性同余方程 $m_i\equiv xr_i+k_is_i(mod\ p-1)$ 中解出 $x,k_1,k_2,...,k_l$ 
  > 注意：加密每个块时 $k$ 都会更换，但是 $x$ 是不换的。因为 $x$ 是由公钥 $(y,g,p)$ 唯一确定的。
- 求解难度：在模 p-1 的意义下，$x$ 的每一个取值可以确定（至少）一组 $\{k_1,k_2,...,k_l\}$ 的取值。由于 p-1 至少有一个大的素因子 q，所以希望求解 $x\ mod\ q$ 需要指数量级的消息-签名对。
  > 注意：只有有一个 $k_i$ 被使用了两次，$x$ 便可以被唯一确定下来。所以为了保证系统的安全性，任何 $k$ 值都不应该被使用两次。

- 突破口 2：直接从 $\alpha^m\equiv y^rr^s(mod\ p)$ 求解 $m$.
- 求解难度：显然与求解离散对数问题难度相同。
- 突破口 3：出发点与突破口 1 类似，尝试在 $k_1,k_2,...,k_l$ 之间建立一些线性依赖关系。如设 $k_i\equiv ck_j(mod\ p-1)$，以达到消掉消元效果。
- 求解难度：如设 $k_i\equiv ck_j(mod\ p-1)$，就有 $r_i\equiv r_j^c(mod\ p)$，$c$ 的求解是离散对数求解问题。
#### 伪造签名的攻击
- 思路 1：给定消息 $m$，攻击者尝试不恢复私钥 $x$，直接找满足 $\alpha^m\equiv y^rr^s(mod\ p)$ 的 $r,s$.
- 求解难度：如果先固定 $s$，那么使用上式求解 $r$ **还没有证明至少和离散对数的求解问题一样困难**；论文假设多项式时间无法求解。可能存在同时求解 $r,s$ 的算法，论文暂未发现。
- 思路 2：攻击者知道一条消息的及其合法签名，就可以生成其他合法签名-消息对。**这种攻击不允许入侵者对任意消息进行签名**，因此不会破坏系统。
  > 这个属性存在于所有现有的数字签名方案中，可以通过要求 $m$ 必须具有某种结构或在签名之前对消息 $m$ 应用单向函数来避免。
- 攻击方法：已知消息 $m$ 的签名 $(r,s)$，故有 $\alpha^m\equiv y^rr^s(mod\ p)$. 选取随机整数 $A,B,C$，使得 $(Ar-Cs,p-1)=1$. 令 $r'=r^A\alpha^By^C(mod\ p)$, $s'=sr'(Ar-Cs)^{-1}(mod\ p-1)$, $m'=r'(Am+Bs)(Ar-Cs)^{-1}(mod\ p-1)$, 则 $(r',s')$ 是消息 $m'$ 的签名。
  > 特别地，取 $A=0$ 不需要已知任何消息-签名对就可以生成合法的消息-签名对。
### 与其他公钥系统和其他签名的对比
- 当前计算离散对数问题和大数因子分解问题的求解时间复杂度都在 $O(e^{\sqrt{cm\ln m}})$ 量级，其中 $m$ 在离散对数问题中是素数 $p$ 的 bit 数；在大数因子分解中是待分解的大整数，$c$ 的近似估计是 0.69. 这意味着我们必须使用大约 RSA 系统中使用的数字的大小来获得相同级别的安全性。因此，public file 的大小比 RSA 的大。(对于 RSA 系统，每个用户都有一个条目n作为他的公钥，以及公共文件中的加密密钥。) <font color=red>那为什么还比 RSA 的 public file 大？Ans：ElGamal 公钥系统的公钥为 $(p,\alpha,y_A)$，即使考虑 $(p,\alpha)$ 在多个用户间共享，每个用户还得有一个 $y_A$ 作为加密的公钥。而 RSA 公钥系统的公钥为 $(N,e)$，$N$ 也是可以在多个用户间共享的，每个用户有一个 $e$ 作为加密的公钥。所以无论是否考虑多用户间共享一部分公钥，ElGamal 公钥系统的 public file 都要比 RSA 的 public file 大。</font>
#### ElGamal 公钥加密系统 v.s.RSA 公钥加密系统
- 概率性加密方案：由于加密操作的随机性（随机数 $k$ 的选取），对同一消息加密两次，将不会得到相同的密文。而 RSA 公钥系统是确定性加密方案。
- 假设 $p$ 的大小与 RSA 系统中 $n$ 的大小相同。则该密文的大小是对应 RSA 密文大小的两倍。
- 加密操作，需要进行两次幂运算,相当于 $GF(p)$ 的 $2\log p$ 次乘法。解密操作，只需要一次幂运算(加上一次除法)。

#### ElGamal 签名方案
- ElGamal 系统和 RSA 系统中使用上述数字大小参数的签名方案，签名都是是消息长度的两倍。
- ElGamal 签名的长度与 RSA 方案所需的长度相同，并且是 Ong 和 Schnorr 发布的基于二次型的新签名方案的一半大小。
  > 注意：由于签名的数量是 $p^2$，而文档的数量只有 $p$，所以每个文档 $m$ 有很多签名，但任何签名只能签署一个文档。<font color=red>完全没有哈希冲突？Ans：确实没有哈希冲突！由签名的过程不难得到：对于给定的明文 $m$ 和选定的随机数 $k$，签名 $(r,s)$ 是唯一的，下面只需要说明对于给定的 $(r,s)$ ，可以唯一确定 $(m,k)$ 即可。考虑 $r \equiv \alpha^k (mod\ p)$，由于原根 $\alpha$ 的阶为 $p-1$ 因此由 $r$ 可以唯一确定 $k$. 再考虑 $m \equiv rx + ks(mod\ p-1)$，对于确定的 $(r,k,s)$ 当然能得到唯一的 $m$. </font>
- 签名需要一次幂运算(加上几次乘法)；验证签名，直观上需要三次幂运算，但 A. Shamir 提出了，只需要1.875次幂运算的改进算法。<font color=red>文章未给出算法过程，只给出了大致思想</font>：通过把 $m,r,s$ 用二进制表示，通过对 $\alpha^{-1}yr$ 整体进行幂运算，并同时记录 $m,r,s$ 不同的二进制位所对应的因子。<font color=red>文章也未给出1.875的证明</font>。

### 注记
- 公钥系统可以很容易地扩展到任何 $GF(p^m)$，但由于最近在计算 $GF(p^m)$ 上的离散对数方面取得了进展，其中 $m$ 很大，建议仍使用 $GF(p)$ 形式。

### Critical Reviews
- Pros：整体的思路架构比较清晰，新的数字签名方法具有开创性。
- Cons：感觉一些技术细节描述不是特别清晰（存疑的地方已在上面标出），也没有明确给出证明过程或者出处；缺少实验验证的环节，没有数据支撑。

## New Directions in Cryptography
[论文速通传送门](https://blog.csdn.net/sinat_36945592/article/details/118711264)
### 疑问
#### V. 相关问题与陷门
- 从密钥到密文的映射就可以作为一个单向函数：$f:K\to C, f(X)=S_X(P_0)$. 对应的求给定 $f(X)$ 中的 $X$ 等价于从已知明文中找出密钥。问题在于不能保证 $f$ 是双射，从而可能较容易实行碰撞攻击。如果 $X$ 在密钥空间中均匀分布，对于一个给定的像 $Y$ 的原像个数服从泊松分布。<font color=red>没有给出原因，而且感觉条件不够充分</font>
- 此外Evans等人提出了另一种构建单向函数的方法，就是不以固定的作为输入，而是使用函数：$f(X)=S_X(X)$. 但是这一方式破坏了在已知明文攻击下的安全性，并且增加了计算的复杂性，破坏了其与单向函数之间的等价性。<font color=red>没有给出原因。</font>

